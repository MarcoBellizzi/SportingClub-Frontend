<div style="background-color: #B9FF98; margin-bottom: 4rem;">
  <app-navbar></app-navbar>

  <div class="p-grid" style="margin-top: 2rem; margin-left: 3rem; margin-right: 3rem;">

    <div class="p-col-8">

      <div class="p-grid">

        <div class="p-col-12">
          <p-card header="Prenotazioni in corso" [style]="{'background-color':'#f8f9fa'}">
            <p-table [value]="prenotazioni">
              <ng-template pTemplate="header">
                <tr>
                  <th width="15%">Giorno</th>
                  <th width="10%">Inizio</th>
                  <th width="10%">Fine</th>
                  <th width="65%">Campo</th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-prenotazione>
                <tr>
                  <td>{{prenotazione.giorno}}</td>
                  <td>{{getInizio(prenotazione)}}</td>
                  <td>{{getFine(prenotazione)}}</td>
                  <td>{{prenotazione.campo.nome}}</td>
                </tr>
              </ng-template>
            </p-table>
          </p-card>
        </div>

        <div class="p-col-12">
          <p-card header="Pagamenti in sospeso" [style]="{'background-color':'#f8f9fa'}">
            <div *ngIf="isAdmin()">
              <button pButton type="button" label="Aggiungi" class="p-button-primary"
                (click)="visualizzaAggiungiDebito()">
              </button>
            </div>
            <p-table [value]="debiti">
              <ng-template pTemplate="header">
                <tr>
                  <th>Atleta</th>
                  <th>Importo</th>
                  <th>Descrizione</th>
                  <th></th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-debito>
                <tr>
                  <td>{{debito.atleta.nome}} {{debito.atleta.cognome}}</td>
                  <td>â‚¬ {{debito.importo}}</td>
                  <td>{{debito.descrizione}}</td>
                  <td>
                    <div *ngIf="isAdmin()">
                      <button pButton type="button" label="Salda" class="p-button-warning" (click)="salda(debito)">
                      </button>
                    </div>
                  </td>
                </tr>
              </ng-template>
            </p-table>
          </p-card>
        </div>

      </div>

    </div>

    <div class="p-col-4">
      <p-card header="Profilo" [style]="{'background-color':'#f8f9fa'}">
        <div style="margin-bottom: 1rem;">
          <label>Nome: {{atleta.nome}}</label>
        </div>
        <div style="margin-bottom: 1rem;">
          <label>Cognome: {{atleta.cognome}}</label>
        </div>
        <div style="margin-bottom: 1rem;">
          <label>Telefono: {{atleta.telefono}}</label>
        </div>
        <div style="margin-bottom: 1rem;">
          <label>Email: {{atleta.email}}</label>
        </div>
        <div style="margin-bottom: 1rem;">
          <label>Livello: {{atleta.livello}}</label>
        </div>
        <div *ngIf="isAdmin()">
          <label>Admin</label>
        </div>
      </p-card>
    </div>

  </div>
</div>

<app-footer></app-footer>


<p-dialog header="Aggiungi nuovo debito" [(visible)]="aggiungiDebito">
  <div style="height: 20rem;">
    <form #f="ngForm" (ngSubmit)="f.form.valid && salvaDebito()" novalidate>

      <div style="margin-bottom: 1rem;">
        <label>Atleta</label>
        <div class="form-group">
          <p-dropdown class="form-control" id="inAtleta" name="inAtleta" #inAtleta="ngModel" required
            [ngClass]="{'is-invalid': f.submitted && inAtleta.invalid }" [options]="atleti" [(ngModel)]="debito.atleta"
            optionLabel="username" placeholder="Atleta">
          </p-dropdown>
          <div *ngIf="inAtleta.dirty && inAtleta.touched && inAtleta.invalid">
            Seleziona un atleta
          </div>
        </div>
      </div>

      <div style="margin-bottom: 1rem;">
        <label>Importo</label>
        <div class="form-group">
          <input pInputText class="form-control" id="inImporto" name="inImporto" #inImporto="ngModel" required
            pattern="[0-9]+" [ngClass]="{'is-invalid': f.submitted && inImporto.invalid }"
            [(ngModel)]="debito.importo" />
        </div>
        <div *ngIf="inImporto.dirty && inImporto.touched && inImporto.invalid">
          Inserire un importo
        </div>
      </div>

      <div style="margin-bottom: 1rem;">
        <label>Descrizione</label>
        <div class="form-group">
          <input pInputText class="form-control" id="inDescrizione" name="inDescrizione" #inDescrizione="ngModel"
            required [ngClass]="{'is-invalid': f.submitted && inDescrizione.invalid }"
            [(ngModel)]="debito.descrizione" />
          <div *ngIf="inDescrizione.dirty && inDescrizione.touched && inDescrizione.invalid">
            Inserire una desrizione
          </div>
        </div>
      </div>

      <div class="form-group">
        <button pButton type="submit" style="margin-left: 2rem;" [disabled]="f.invalid" label="Salva"
          class="p-button-primary"></button>
      </div>

    </form>
  </div>
</p-dialog>

<p-toast position="bottom-left" key="tc"></p-toast>